UNO-Templater
=============

Шаблонизатор для LibreOffice, который использует Java UNO API для своей работы.
Полностью написан на языке Java. Позволяет автоматизировать подготовку
документов, оформленных в соответствии с какими-либо стандартами (например,
ГОСТ 7.32-2017). Шаблонизатор работает, в первую очередь, с документами в
формате ODT, однако возможна поддержка и любых других форматов.

Шаблонизатор может быть составным элементом системы автоматической подготовки
программной и научной документации. В первую очередь, он исправляет некоторые
недочёты, которые возникают при преобразовании документа из Markdown в ODT при
помощи Pandoc (например, формулы и их привязка).

Поддерживаемые возможности
--------------------------

1. Подстановка текста документов в шаблон
2. Подстановка оглавления
3. Разворачивание строковых макросов
4. Исправление формул StarMath
5. Оформление всех таблиц (за исключением тех, что находятся в секциях,
начинающихся на `eq:` и `unproc-tbl:`)
6. Выравнивание формул и изображений по центру
7. Установка привязки формул и изображений как символов
8. Оформление списков в соответствии с ГОСТ 7.32-2017

Использование
-------------

UNO-Templater - консольное приложение на Java. Для его работы требуется Java 
версии не ниже 18, поскольку в Java предыдущих версий имеются проблемы с
кодировкой UTF-8: строки интерпретируются в нативной кодировке ОС, из-за чего
возникают проблемы с их передачей в LibreOffice.

Ключи программы UNO-Templater:

    templater  [-D] [-M (--macros) MACRO_FILE] [-e (--embed-fonts)] [-f (--force, --overwrite)] [-h (--help, -?)] [-m (--main-text) MAINFILE] [-o (--output) OUTFILE] [-t (--template) TEMPLATE] [-P (--pdf, --make-pdf)]

    -e (--embed-fonts)        : встроить шрифты
    -f (--force, --overwrite) : перезаписать выходной файл
    -m (--main-text) MAINFILE : файл с основным текстом
    -o (--output) OUTFILE     : выходной файл
    -t (--template) TEMPLATE  : файл шаблона
    -P (--pdf, --make-pdf)    : сгенерировать PDF
    -D (key=value)            : строковый макрос
    -M (--macros) MACRO_FILE  : задать файл с макросами

Подстановка макросов
--------------------

Макросы обрабатываются в следующем порядке:

1. Обрабатывается включение основного текста (макрос `%MAIN_TEXT%`)
2. Обрабатывается включение других документов (макрос `%INCLUDE(filename)%`, где
filename - имя включаемого файла)
3. Подставляется оглавление на месте макроса `%TOC%`
4. В самом конце - подставляются счётчики страниц, рисунков, таблиц в тексте 
(макросы `%N_PAGES%`, `%N_FIGURES%`, `%N_TABLES%`)

